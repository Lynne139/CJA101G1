<div class="main_resto_timeslot">

	<div class="mt-5 mb-5">
		<h2 class="page_title">時段管理</h2>
	</div>

	<!-- 餐廳選擇器 -->
	<form class="select_resto filter panel p-4 mb-4" method="get" th:action="@{/admin/resto_timeslot}">
		<div class="row mb-3">
			<div class="col-12">
				<label class="form-label fs-5 mt-2">選擇餐廳</label>
				<select id="restoSelect" class="form-select w-100" name="restoId" onchange="this.form.submit()">
					<option disabled th:selected="${selectedRestoId == null}">--- 餐廳 ---</option>
					<option th:each="resto : ${restoList}" th:value="${resto.restoId}" th:text="${resto.restoName}"
						th:selected="${resto.restoId == selectedRestoId}"></option>
				</select>

			</div>
		</div>
	</form>
  

    <!-- 區段與時段 Panel -->
    
    <div class="panel p-4">

        <div th:if="${selectedResto == null}" class="text-center">請先選擇餐廳，以載入開放時段</div>
        
        <!-- 若無選餐廳提示 -->
        <h4 class="resto_name mb-4" th:if="${selectedResto != null}" th:text="${selectedResto.restoName}"></h4>

        
        <!-- 新增類別按鈕 -->
        <div class="d-flex justify-content-end">
            <button th:if="${selectedResto != null}" class="btn btn_primary btn_add col-12 mt-5 mb-4" id="btnAddPeriod">新增類別</button>
        </div>
        
        <!-- 若餐廳無區段內容提示 -->
        <div class="text-center mb-4" th:if="${selectedResto != null And #lists.isEmpty(periodList)}">目前無設置類別，請先新增至少一項類別以加入時段</div>
        
        
        <div class="d-flex flex-column gap-5">
        
            
            <div th:if="${periodList != null}" th:each="period,iter : ${periodList}" th:class="'pt-1'">
                <div class="d-flex justify-content-between align-items-center">
                    <h5 class="panel-subtitle mb-0" th:text="${period.periodName}">類別名稱</h5>
                    <div>
                        <button class="btn_icon btn_edit me-1" title="編輯區段" th:data-id="${period.periodId}">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn_icon btn_delete me-1" title="刪除區段" th:data-id="${period.periodId}">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </div>
                <!-- 分隔線 -->
                <hr class="my-3">
    
                <div class="d-flex flex-wrap gap-2 mt-2">
                    <!-- 過濾屬於此 period 的 timeslot -->
                    <div th:each="timeslot : ${timeslotList}"
                        th:if="${timeslot.periodVO != null and timeslot.periodVO.periodId == period.periodId}"
                        th:data-timeslot-id="${timeslot.timeslotId}">
                        
                        <div class="timeslot_block d-flex justify-content-between align-items-center">
                            <div class="px-2 timeslot_name" th:text="${timeslot.timeslotName}">07:00</div>
                            
                            <div class="px-3">|</div>
                            <div class="d-flex justify-content-end align-items-center">
                              <button class="btn btn_icon btn_edit py-1 px-2" title="編輯" th:data-id="${timeslot.timeslotId}">
                                  <i class="fas fa-edit"></i>
                              </button>
                              <button class="btn btn_icon btn_delete py-1 px-2" title="刪除" th:data-id="${timeslot.timeslotId}">
                                  <i class="fas fa-trash"></i>
                              </button>
                            </div>
                            
                        </div>
                    </div>
                    <!-- 新增時段按鈕 -->
                    <button class=" btn btn_primary" id="btnAddTimeslot">+</button>
                </div>
            </div>
        </div>
        
        
    </div>


</div>